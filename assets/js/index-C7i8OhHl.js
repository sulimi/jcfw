import{b as e,s as a,t,u as l,v as r,c as u,w as o,x as s,y as d,q as n,r as i,z as m,A as p,B as c,f as v,p as y,C as h,D as f,F as b,G as _,H as w}from"./element-plus-DzEfNFEh.js";import{E as A,F as g}from"./@element-plus-UY_HfQnI.js";import{i as V}from"./echarts-DLS1qI9h.js";import{u as k}from"./vue-router-BQuPhA_r.js";import{a as D}from"./index-DQPoPE4b.js";import{U as N,r as S,Q as x,w as R,i as j,c as z,a as G,L as C,J as B,n as U,o as O,O as P,a2 as L,H as T,I as E,u as M,R as q}from"./@vue-DMj6kJP1.js";import"./lodash-es-Dfcc72EO.js";import"./@vueuse-D6tFO15K.js";import"./async-validator-BTKOuuO-.js";import"./@ctrl-D2oWfImC.js";import"./@popperjs-CpAfbxx4.js";import"./normalize-wheel-es-Vn5vHDCm.js";import"./tslib-ZseNXxlj.js";import"./zrender-COFpJYBb.js";import"./pinia-DgxDnLzq.js";import"./axios-DMXdiZgf.js";const F=[{id:"1",plateNumber:"京A12345",driverName:"张三",loanAmount:3e5,overdueAmount:5e4,overdueDays:45,repaymentStatus:"partial",lastRepaymentDate:"2024-01-05"},{id:"2",plateNumber:"京B67890",driverName:"李四",loanAmount:25e4,overdueAmount:8e4,overdueDays:75,repaymentStatus:"unpaid",lastRepaymentDate:"2023-12-20"},{id:"3",plateNumber:"京B67890",driverName:"李四",loanAmount:25e4,overdueAmount:8e4,overdueDays:75,repaymentStatus:"unpaid",lastRepaymentDate:"2023-12-20"},{id:"4",plateNumber:"京B67890",driverName:"李四",loanAmount:25e4,overdueAmount:8e4,overdueDays:75,repaymentStatus:"unpaid",lastRepaymentDate:"2023-12-20"},{id:"5",plateNumber:"京B67890",driverName:"李四",loanAmount:25e4,overdueAmount:8e4,overdueDays:75,repaymentStatus:"unpaid",lastRepaymentDate:"2023-12-20"},{id:"6",plateNumber:"京B67890",driverName:"李四",loanAmount:25e4,overdueAmount:8e4,overdueDays:75,repaymentStatus:"unpaid",lastRepaymentDate:"2023-12-20"},{id:"7",plateNumber:"京B67890",driverName:"李四",loanAmount:25e4,overdueAmount:8e4,overdueDays:75,repaymentStatus:"unpaid",lastRepaymentDate:"2023-12-20"},{id:"8",plateNumber:"京B67890",driverName:"李四",loanAmount:25e4,overdueAmount:8e4,overdueDays:75,repaymentStatus:"unpaid",lastRepaymentDate:"2023-12-20"},{id:"9",plateNumber:"京B67890",driverName:"李四",loanAmount:25e4,overdueAmount:8e4,overdueDays:75,repaymentStatus:"unpaid",lastRepaymentDate:"2023-12-20"},{id:"10",plateNumber:"京B67890",driverName:"李四",loanAmount:25e4,overdueAmount:8e4,overdueDays:75,repaymentStatus:"unpaid",lastRepaymentDate:"2023-12-20"}],H={class:"loan-statistics-container"},I={class:"content"},J={class:"card-content"},Q={class:"card-value"},X={class:"card-compare"},$={class:"card-content"},K={class:"card-value"},W={class:"card-compare"},Y={class:"card-content"},Z={class:"card-value"},ee={class:"card-compare"},ae={class:"card-content"},te={class:"card-value"},le={class:"card-compare"},re={class:"card-header"},ue={class:"table-header"},oe={class:"header-operations"},se={class:"dialog-footer"},de=D({__name:"index",setup(D){const de=k(),ne=N({totalLoanAmount:1e7,totalOverdueAmount:2e6,overdueRate:20,overdueVehicles:150,loanAmountGrowth:5,overdueAmountGrowth:-2,overdueRateGrowth:-1,overdueVehiclesGrowth:-3}),ie=N({plateNumber:"",overdueDuration:"",minAmount:null,maxAmount:null,repaymentStatus:""}),me=S(!1),pe=S([]),ce=N({currentPage:1,pageSize:10,total:0}),ve=S(!1),ye=S(null),he=S(null),fe=N({amount:0,method:"bank",remark:""}),be={amount:[{required:!0,message:"请输入还款金额",trigger:"blur"}],method:[{required:!0,message:"请选择还款方式",trigger:"change"}]},_e=S(null),we=S(null);let Ae=null,ge=null;const Ve=S("month"),ke=()=>({title:{text:"逾期金额趋势"},tooltip:{trigger:"axis",formatter:"{b}<br/>逾期金额：¥{c}"},xAxis:{type:"category",data:["1月","2月","3月","4月","5月","6月"]},yAxis:{type:"value",axisLabel:{formatter:e=>`¥${je(e)}`}},series:[{data:[15e5,18e5,2e6,19e5,22e5,2e6],type:"line",smooth:!0,areaStyle:{}}]}),De=async()=>(Ae&&(Ae.dispose(),Ae=null),ge&&(ge.dispose(),ge=null),await U(),new Promise((e=>{setTimeout((()=>{_e.value&&(Ae=V(_e.value),Ae.setOption(ke())),we.value&&(ge=V(we.value),ge.setOption({title:{text:"逾期时长分布"},tooltip:{trigger:"item",formatter:"{b}: {c}辆 ({d}%)"},series:[{type:"pie",radius:["40%","70%"],data:[{value:80,name:"1-30天"},{value:40,name:"31-60天"},{value:20,name:"61-90天"},{value:10,name:"90天以上"}],emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]})),e()}),300)}))),Ne=()=>{Ae&&Ae.resize(),ge&&ge.resize()};x((()=>{null==Ae||Ae.dispose(),null==ge||ge.dispose()})),window.addEventListener("resize",Ne),x((()=>{window.removeEventListener("resize",Ne)})),R(Ve,(async()=>{Ae&&Ae.setOption(ke())})),j((async()=>{await Se(),setTimeout((async()=>{await De()}),100)}));const Se=async()=>{me.value=!0;try{pe.value=F,ce.total=100}catch(a){e.error("获取逾期列表失败")}finally{me.value=!1}},xe=()=>{ce.currentPage=1,Se()},Re=()=>{Object.keys(ie).forEach((e=>{ie[e]=e.includes("Amount")?null:""})),xe()},je=e=>e?e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","):"0",ze=e=>({unpaid:"未还",partial:"部分还款",paid:"已还清"}[e]||"未知"),Ge=async()=>{ye.value&&await ye.value.validate((async a=>{if(a)try{e.success("登记还款成功"),ve.value=!1,Se()}catch(t){e.error("登记还款失败")}}))},Ce=()=>{r.confirm("确定要导出当前筛选条件下的数据吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"info"}).then((async()=>{try{e.success("导出成功")}catch(a){e.error("导出失败")}})).catch((()=>{}))},Be=e=>{ce.pageSize=e,Se()},Ue=e=>{ce.currentPage=e,Se()};return R((()=>de.path),(async e=>{"/statistics"===e&&(await U(),setTimeout((async()=>{await De()}),100))})),(e,r)=>{const V=u,k=a,D=o,N=t,S=s,x=d,R=n,j=i,U=m,F=p,de=c,Ae=v,ge=y,ke=h,De=f,Ne=b,Se=_,Oe=l,Pe=w;return O(),z("div",H,[G("div",I,[C(N,{gutter:20},{default:B((()=>[C(D,{span:6},{default:B((()=>[C(k,{shadow:"hover",class:"statistics-card"},{default:B((()=>[G("div",J,[r[14]||(r[14]=G("div",{class:"card-title"},"总贷款金额",-1)),G("div",Q,"¥"+P(je(ne.totalLoanAmount)),1),G("div",X,[r[13]||(r[13]=L(" 较上月 ")),G("span",{class:T(ne.loanAmountGrowth>=0?"up":"down")},[L(P(Math.abs(ne.loanAmountGrowth))+"% ",1),C(V,null,{default:B((()=>[ne.loanAmountGrowth>=0?(O(),E(M(A),{key:0})):(O(),E(M(g),{key:1}))])),_:1})],2)])])])),_:1})])),_:1}),C(D,{span:6},{default:B((()=>[C(k,{shadow:"hover",class:"statistics-card"},{default:B((()=>[G("div",$,[r[16]||(r[16]=G("div",{class:"card-title"},"逾期总额",-1)),G("div",K,"¥"+P(je(ne.totalOverdueAmount)),1),G("div",W,[r[15]||(r[15]=L(" 较上月 ")),G("span",{class:T(ne.overdueAmountGrowth>=0?"up":"down")},[L(P(Math.abs(ne.overdueAmountGrowth))+"% ",1),C(V,null,{default:B((()=>[ne.overdueAmountGrowth>=0?(O(),E(M(A),{key:0})):(O(),E(M(g),{key:1}))])),_:1})],2)])])])),_:1})])),_:1}),C(D,{span:6},{default:B((()=>[C(k,{shadow:"hover",class:"statistics-card"},{default:B((()=>[G("div",Y,[r[18]||(r[18]=G("div",{class:"card-title"},"逾期率",-1)),G("div",Z,P(ne.overdueRate)+"%",1),G("div",ee,[r[17]||(r[17]=L(" 较上月 ")),G("span",{class:T(ne.overdueRateGrowth>=0?"up":"down")},[L(P(Math.abs(ne.overdueRateGrowth))+"% ",1),C(V,null,{default:B((()=>[ne.overdueRateGrowth>=0?(O(),E(M(A),{key:0})):(O(),E(M(g),{key:1}))])),_:1})],2)])])])),_:1})])),_:1}),C(D,{span:6},{default:B((()=>[C(k,{shadow:"hover",class:"statistics-card"},{default:B((()=>[G("div",ae,[r[20]||(r[20]=G("div",{class:"card-title"},"逾期车辆数",-1)),G("div",te,P(je(ne.overdueVehicles)),1),G("div",le,[r[19]||(r[19]=L(" 较上月 ")),G("span",{class:T(ne.overdueVehiclesGrowth>=0?"up":"down")},[L(P(Math.abs(ne.overdueVehiclesGrowth))+"% ",1),C(V,null,{default:B((()=>[ne.overdueVehiclesGrowth>=0?(O(),E(M(A),{key:0})):(O(),E(M(g),{key:1}))])),_:1})],2)])])])),_:1})])),_:1})])),_:1}),C(N,{gutter:20,class:"chart-row"},{default:B((()=>[C(D,{span:12},{default:B((()=>[C(k,{class:"chart-card"},{header:B((()=>[G("div",re,[r[24]||(r[24]=G("span",null,"逾期金额趋势",-1)),C(x,{modelValue:Ve.value,"onUpdate:modelValue":r[0]||(r[0]=e=>Ve.value=e),size:"small"},{default:B((()=>[C(S,{value:"week"},{default:B((()=>r[21]||(r[21]=[L("最近一周")]))),_:1}),C(S,{value:"month"},{default:B((()=>r[22]||(r[22]=[L("最近一月")]))),_:1}),C(S,{value:"year"},{default:B((()=>r[23]||(r[23]=[L("最近一年")]))),_:1})])),_:1},8,["modelValue"])])])),default:B((()=>[G("div",{class:"chart-container",ref_key:"amountChartRef",ref:_e},null,512)])),_:1})])),_:1}),C(D,{span:12},{default:B((()=>[C(k,{class:"chart-card"},{header:B((()=>r[25]||(r[25]=[G("div",{class:"card-header"},[G("span",null,"逾期时长分布")],-1)]))),default:B((()=>[G("div",{class:"chart-container",ref_key:"durationChartRef",ref:we},null,512)])),_:1})])),_:1})])),_:1}),C(k,{class:"search-card"},{default:B((()=>[C(ge,{inline:!0,model:ie,class:"search-form"},{default:B((()=>[C(j,{label:"车牌号"},{default:B((()=>[C(R,{modelValue:ie.plateNumber,"onUpdate:modelValue":r[1]||(r[1]=e=>ie.plateNumber=e),placeholder:"请输入车牌号",clearable:""},null,8,["modelValue"])])),_:1}),C(j,{label:"逾期时长"},{default:B((()=>[C(F,{modelValue:ie.overdueDuration,"onUpdate:modelValue":r[2]||(r[2]=e=>ie.overdueDuration=e),placeholder:"请选择逾期时长",clearable:""},{default:B((()=>[C(U,{label:"1-30天",value:"1-30"}),C(U,{label:"31-60天",value:"31-60"}),C(U,{label:"61-90天",value:"61-90"}),C(U,{label:"90天以上",value:"90+"})])),_:1},8,["modelValue"])])),_:1}),C(j,{label:"逾期金额"},{default:B((()=>[C(de,{modelValue:ie.minAmount,"onUpdate:modelValue":r[3]||(r[3]=e=>ie.minAmount=e),min:0,step:1e3,placeholder:"最小金额"},null,8,["modelValue"]),r[26]||(r[26]=G("span",{class:"separator"},"-",-1)),C(de,{modelValue:ie.maxAmount,"onUpdate:modelValue":r[4]||(r[4]=e=>ie.maxAmount=e),min:0,step:1e3,placeholder:"最大金额"},null,8,["modelValue"])])),_:1}),C(j,{label:"还款状态"},{default:B((()=>[C(F,{modelValue:ie.repaymentStatus,"onUpdate:modelValue":r[5]||(r[5]=e=>ie.repaymentStatus=e),placeholder:"请选择还款状态",clearable:""},{default:B((()=>[C(U,{label:"未还",value:"unpaid"}),C(U,{label:"部分还款",value:"partial"}),C(U,{label:"已还清",value:"paid"})])),_:1},8,["modelValue"])])),_:1}),C(j,null,{default:B((()=>[C(Ae,{type:"primary",onClick:xe},{default:B((()=>r[27]||(r[27]=[L("搜索")]))),_:1}),C(Ae,{onClick:Re},{default:B((()=>r[28]||(r[28]=[L("重置")]))),_:1})])),_:1})])),_:1},8,["model"])])),_:1}),C(k,null,{header:B((()=>[G("div",ue,[r[30]||(r[30]=G("span",null,"逾期详细数据",-1)),G("div",oe,[C(Ae,{type:"primary",onClick:Ce},{default:B((()=>r[29]||(r[29]=[L("导出数据")]))),_:1})])])])),default:B((()=>[q((O(),E(Ne,{data:pe.value,border:"",style:{width:"100%"}},{default:B((()=>[C(ke,{prop:"plateNumber",label:"车牌号"}),C(ke,{prop:"driverName",label:"司机姓名"}),C(ke,{prop:"loanAmount",label:"贷款金额"},{default:B((({row:e})=>[L(" ¥"+P(je(e.loanAmount)),1)])),_:1}),C(ke,{prop:"overdueAmount",label:"逾期金额"},{default:B((({row:e})=>[L(" ¥"+P(je(e.overdueAmount)),1)])),_:1}),C(ke,{prop:"overdueDays",label:"逾期天数"},{default:B((({row:e})=>[L(P(e.overdueDays)+"天 ",1)])),_:1}),C(ke,{prop:"repaymentStatus",label:"还款状态"},{default:B((({row:e})=>{return[C(De,{type:(a=e.repaymentStatus,{unpaid:"danger",partial:"warning",paid:"success"}[a]||"info")},{default:B((()=>[L(P(ze(e.repaymentStatus)),1)])),_:2},1032,["type"])];var a})),_:1}),C(ke,{prop:"lastRepaymentDate",label:"最近还款日期"}),C(ke,{label:"操作",width:"200",fixed:"right"},{default:B((({row:e})=>[C(Ae,{type:"primary",link:"",onClick:e=>{}},{default:B((()=>r[31]||(r[31]=[L("查看详情")]))),_:2},1032,["onClick"]),C(Ae,{type:"success",link:"",onClick:a=>(e=>{he.value=e,fe.amount=0,fe.method="bank",fe.remark="",ve.value=!0})(e)},{default:B((()=>r[32]||(r[32]=[L("登记还款")]))),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])),[[Pe,me.value]]),C(Se,{"current-page":ce.currentPage,"onUpdate:currentPage":r[6]||(r[6]=e=>ce.currentPage=e),"page-size":ce.pageSize,"onUpdate:pageSize":r[7]||(r[7]=e=>ce.pageSize=e),size:"small","page-sizes":[10,20,50,100],total:ce.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:Be,onCurrentChange:Ue,class:"pagination-container"},null,8,["current-page","page-size","total"])])),_:1}),C(Oe,{title:"登记还款",modelValue:ve.value,"onUpdate:modelValue":r[12]||(r[12]=e=>ve.value=e),width:"500px"},{footer:B((()=>[G("span",se,[C(Ae,{onClick:r[11]||(r[11]=e=>ve.value=!1)},{default:B((()=>r[33]||(r[33]=[L("取消")]))),_:1}),C(Ae,{type:"primary",onClick:Ge},{default:B((()=>r[34]||(r[34]=[L("确定")]))),_:1})])])),default:B((()=>[C(ge,{ref_key:"repaymentFormRef",ref:ye,model:fe,rules:be,"label-width":"100px"},{default:B((()=>[C(j,{label:"车牌号"},{default:B((()=>{var e;return[G("span",null,P(null==(e=he.value)?void 0:e.plateNumber),1)]})),_:1}),C(j,{label:"逾期金额"},{default:B((()=>{var e;return[G("span",null,"¥"+P(je(null==(e=he.value)?void 0:e.overdueAmount)),1)]})),_:1}),C(j,{label:"还款金额",prop:"amount"},{default:B((()=>{var e;return[C(de,{modelValue:fe.amount,"onUpdate:modelValue":r[8]||(r[8]=e=>fe.amount=e),min:0,max:null==(e=he.value)?void 0:e.overdueAmount,precision:2,style:{width:"100%"}},null,8,["modelValue","max"])]})),_:1}),C(j,{label:"还款方式",prop:"method"},{default:B((()=>[C(F,{modelValue:fe.method,"onUpdate:modelValue":r[9]||(r[9]=e=>fe.method=e),style:{width:"100%"}},{default:B((()=>[C(U,{label:"银行转账",value:"bank"}),C(U,{label:"现金",value:"cash"}),C(U,{label:"其他",value:"other"})])),_:1},8,["modelValue"])])),_:1}),C(j,{label:"备注",prop:"remark"},{default:B((()=>[C(R,{modelValue:fe.remark,"onUpdate:modelValue":r[10]||(r[10]=e=>fe.remark=e),type:"textarea",rows:3,placeholder:"请输入备注信息"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue"])])])}}},[["__scopeId","data-v-e76c3656"]]);export{de as default};
